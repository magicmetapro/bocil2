<!DOCTYPE html> 
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Cocokkan Warna & Bentuk</title>
  <style>
    body {
      font-family: 'Comic Sans MS', cursive;
      background: linear-gradient(to right, #e0f7fa, #e8f5e9);
      text-align: center;
      padding: 30px;
    }

    h1 {
      color: teal;
    }

    #level {
      font-weight: bold;
      margin-bottom: 20px;
    }

    .container {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 30px;
      margin-top: 30px;
    }

    .slot, .shape {
      width: 80px;
      height: 80px;
      display: flex;
      align-items: center;
      justify-content: center;
      position: relative;
    }

    .slot {
      border: 3px dashed #aaa;
    }

    .shape {
      cursor: grab;
      background-color: transparent;
    }

    .success {
      border: 3px solid limegreen !important;
    }

    #nextLevelMsg {
      font-size: 1.2rem;
      color: green;
      font-weight: bold;
      margin-top: 20px;
    }

    svg {
      width: 60px;
      height: 60px;
    }
  </style>
</head>
<body>
  <h1>ðŸŽ¨ Cocokkan Warna & Simbol ðŸŽ¨</h1>
  <div id="level">LEVEL 1</div>

  <div class="container" id="slotsContainer"></div>
  <div class="container" id="shapesContainer"></div>
  <div id="nextLevelMsg"></div>

  <script>
    let level = 1;

    // Ganti allShapes jadi simbol hewan, kendaraan, buah
    const allShapes = ['cat', 'bird', 'fish', 'car', 'plane', 'bike', 'apple', 'banana', 'grape'];

    const allColors = ['purple', 'blue', 'red', 'green', 'orange', 'deeppink', 'gold'];

    const slotsContainer = document.getElementById("slotsContainer");
    const shapesContainer = document.getElementById("shapesContainer");
    const levelLabel = document.getElementById("level");
    const nextLevelMsg = document.getElementById("nextLevelMsg");

    function shuffle(arr) {
      return arr.sort(() => 0.5 - Math.random());
    }

    function randomShapeData(count) {
      const data = [];
      const used = new Set();
      while (data.length < count) {
        const shape = allShapes[Math.floor(Math.random() * allShapes.length)];
        const color = allColors[Math.floor(Math.random() * allColors.length)];
        const key = `${shape}-${color}`;
        if (!used.has(key)) {
          used.add(key);
          data.push({ shape, color });
        }
      }
      return data;
    }

    // Buat SVG simbol berdasarkan tipe shape & warna stroke/fill
    function createSymbolSVG(shape, color, filled = false) {
      const svgNS = "http://www.w3.org/2000/svg";
      const svg = document.createElementNS(svgNS, "svg");
      svg.setAttribute("viewBox", "0 0 64 64");

      let path;

      switch(shape) {
        // Hewan
        case 'cat':
          path = document.createElementNS(svgNS, "path");
          path.setAttribute("d", "M32 2 L24 14 L16 14 L10 30 L18 32 L14 42 L20 40 L22 48 L30 44 L38 48 L40 40 L46 42 L42 32 L50 30 L44 14 L36 14 Z");
          break;
        case 'bird':
          path = document.createElementNS(svgNS, "path");
          path.setAttribute("d", "M2 30 Q16 10 28 24 Q40 8 54 28 Q50 36 60 38 Q40 44 28 40 Q14 52 2 44 Z");
          break;
        case 'fish':
          path = document.createElementNS(svgNS, "path");
          path.setAttribute("d", "M10 32 Q20 10 38 22 Q54 10 54 42 Q38 34 20 54 Q10 40 10 32 Z");
          break;

        // Kendaraan
        case 'car':
          path = document.createElementNS(svgNS, "rect");
          path.setAttribute("x", "10");
          path.setAttribute("y", "24");
          path.setAttribute("width", "44");
          path.setAttribute("height", "18");
          path.setAttribute("rx", "6");
          path.setAttribute("ry", "6");
          break;
        case 'plane':
          path = document.createElementNS(svgNS, "polygon");
          path.setAttribute("points", "32,2 42,24 62,26 44,34 48,54 32,44 16,54 20,34 2,26 22,24");
          break;
        case 'bike':
          path = document.createElementNS(svgNS, "circle");
          path.setAttribute("cx", "20");
          path.setAttribute("cy", "44");
          path.setAttribute("r", "10");
          break;

        // Buah
        case 'apple':
          path = document.createElementNS(svgNS, "circle");
          path.setAttribute("cx", "32");
          path.setAttribute("cy", "32");
          path.setAttribute("r", "20");
          break;
        case 'banana':
          path = document.createElementNS(svgNS, "path");
          path.setAttribute("d", "M22 12 Q38 10 44 28 Q50 44 40 52 Q28 54 22 40 Q18 30 22 12 Z");
          break;
        case 'grape':
          path = document.createElementNS(svgNS, "circle");
          // Untuk anggur, bikin cluster 7 lingkaran kecil
          const group = document.createElementNS(svgNS, "g");
          const coords = [
            [32, 20], [24, 28], [40, 28], [18, 38], [32, 38], [46, 38], [32, 50]
          ];
          coords.forEach(([cx, cy]) => {
            const c = document.createElementNS(svgNS, "circle");
            c.setAttribute("cx", cx);
            c.setAttribute("cy", cy);
            c.setAttribute("r", "6");
            c.setAttribute("fill", filled ? color : "none");
            c.setAttribute("stroke", color);
            c.setAttribute("stroke-width", "2");
            group.appendChild(c);
          });
          svg.appendChild(group);
          path = null;
          break;
      }

      if (path) {
        if (filled) {
          path.setAttribute("fill", color);
          path.setAttribute("stroke", "black");
          path.setAttribute("stroke-width", "2");
        } else {
          path.setAttribute("fill", "none");
          path.setAttribute("stroke", color);
          path.setAttribute("stroke-width", "3");
        }
        svg.appendChild(path);
      }

      return svg;
    }

    function setupLevel() {
      nextLevelMsg.textContent = "";
      levelLabel.textContent = `LEVEL ${level}`;
      slotsContainer.innerHTML = "";
      shapesContainer.innerHTML = "";

      const count = Math.min(level + 2, 9);
      const shapeData = randomShapeData(count);
      const shuffled = shuffle([...shapeData]);

      let correctMatches = 0;

      // Buat slot (outline simbol)
      shapeData.forEach(({ shape, color }) => {
        const slot = document.createElement("div");
        slot.className = `slot ${shape}`;
        slot.setAttribute("data-shape", shape);
        slot.setAttribute("data-color", color);

        const svg = createSymbolSVG(shape, color, false);
        slot.appendChild(svg);

        slot.addEventListener("dragover", (e) => e.preventDefault());
        slot.addEventListener("drop", function (e) {
          const shapeId = e.dataTransfer.getData("text/plain");
          const draggedEl = document.getElementById(shapeId);
          const draggedShape = draggedEl.getAttribute("data-shape");
          const draggedColor = draggedEl.getAttribute("data-color");

          if (shape === draggedShape && color === draggedColor) {
            this.classList.add("success");
            this.innerHTML = ""; // Hapus slot svg outline
            this.appendChild(draggedEl);
            draggedEl.setAttribute("draggable", "false");
            correctMatches++;

            if (correctMatches === count) {
              nextLevelMsg.textContent = "âœ… Hebat! Naik ke Level Berikutnya...";
              setTimeout(() => {
                level++;
                setupLevel();
              }, 1500);
            }
          }
        });

        slotsContainer.appendChild(slot);
      });

      // Buat shapes (filled simbol)
      shuffled.forEach(({ shape, color }, idx) => {
        const shapeEl = document.createElement("div");
        shapeEl.id = `shape-${idx}`;
        shapeEl.setAttribute("data-shape", shape);
        shapeEl.setAttribute("data-color", color);
        shapeEl.setAttribute("draggable", "true");
        shapeEl.className = "shape";

        const svg = createSymbolSVG(shape, color, true);
        shapeEl.appendChild(svg);

        shapeEl.addEventListener("dragstart", (e) => {
          e.dataTransfer.setData("text/plain", shapeEl.id);
        });

        shapesContainer.appendChild(shapeEl);
      });
    }

    setupLevel();
  </script>
</body>
</html>
